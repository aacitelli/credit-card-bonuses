name: Deploy `main` Branch

on:
  push:
    branches:
      - main

concurrency:
  # If this workflow is already running, wait for the previous iteration to complete. Otherwise, Serverless doesn't really know how to handle deploying when a deploy is in progress, and will error out.
  group: ${{ github.workflow }}

jobs:
  deploy:
    uses: ./.github/workflows/reusable/deploy.yml
    with:
      stage: production